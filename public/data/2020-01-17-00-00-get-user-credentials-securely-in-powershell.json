{
  "filename": "2020-01-17-00-00-get-user-credentials-securely-in-powershell.json",
  "title": "Get user credentials securely in PowerShell",
  "type": "featured",
  "tags": [
    "powershell"
  ],
  "author": "Christopher Snay",
  "cover": "",
  "blocks": [
    {
      "content": "#Get user credentials securely\nTry {\n\t$credentials = Get-Credential \"$env:username\"\n}\nCatch {\n\t$log += \"`n- \" + $_.Exception.Message\n\tOutput-Result\n}\n\n#Get current domain to use for authentication. ADSI = Active Directory\n$currentDomain = \"LDAP://\" + ([ADSI]\"\").distinguishedName\n\n#Authenticate\n$activeDirectoryEntry = New-Object System.DirectoryServices.DirectoryEntry($currentDomain,$credentials.GetNetworkCredential().UserName,$credentials.GetNetworkCredential().Password)\nif ($activeDirectoryEntry.name -eq $null)\n{\n    $log += \"`n- Failed to authenticate that username and password.\"\n    Output-Result\t\n} else {\n    $log += \"`n- Authentication was successful.\"\n}\n\n#Display Results\n$log = \"Results:\"\nfunction Output-Result {\n    [System.Reflection.Assembly]::LoadWithPartialName(\"System.Windows.Forms\") > null\n    $oReturn=[System.Windows.Forms.Messagebox]::Show($log)\n    Break\n}",
      "type": "code"
    }
  ],
  "date": "2020-01-17T00:00:00Z",
  "updated": "2025-12-19T02:40:37.721630Z"
}